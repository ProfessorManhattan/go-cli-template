---
project_name: go-cli-template

env:
  - GOVERSION="$(go version)"

before:
  hooks:
    - go mod tidy

build:
  binary: ''
  main: main.go
  goos:
    - windows
    - darwin
    - linux
  goarch:
    - 386
    - amd64
    - arm
    - arm64
  goarm:
    - 6
  ignore:
    - goos: darwin
      goarch: 386
  env:
    - CGO_ENABLED=0
  ldflags:
    # yamllint disable-line rule:line-length
    - '-s -w -X "main.version={{.Version}}" -X "main.commit={{.Commit}}" -X "main.date={{.Date}}" -X "main.builtBy=Megabyte Labs" -X "main.goversion={{.Env.GOVERSION}}"'

gomod:
  proxy: true

archives:
  - files:
      - README.md
      - LICENSE
      - completion/**/*
    format_overrides:
      - goos: windows
        format: zip
    replacements:
      amd64: 64-bit
      386: 32-bit
      darwin: macOS
      linux: Linux

universal_binaries:
  - replace: true

release:
  disable: true

snapshot:
  name_template: '{{.Tag}}'

checksum:
  name_template: CHECKSUMS.txt

nfpms:
  - id: default
    vendor: Megabyte LLC
    homepage: 'https://megabyte.space'
    maintainer: Megabyte Labs <help@megabyte.space>
    description: A starting template for Go CLI projects
    license: MIT
    formats:
      - apk
      - deb
      - rpm
    recommends:
      - git
    suggests:
      - docker
      - jq
      - yq
    replacements:
      amd64: 64-bit
      386: 32-bit
      darwin: macOS
      linux: Linux

snapcrafts:
  - id: default
    publish: true
    summary: A starting template for Go CLI projects
    # yamllint disable-line rule:line-length
    description: 'This project is a boilerplate for Go CLI projects. It includes common files that are shared throughout the Megabyte Labs ecosystem. It also includes a basic project structure. It does not attempt to dictate project structure - it just takes care of all the meta-tasks like configuring CI, linters, and build tools.'
    replacements:
      amd64: 64-bit
      386: 32-bit
      darwin: macOS
      linux: Linux
    confinement: classic
    license: MIT
    extra_files:
      - source: completion
        destination: completion
        mode: 0755

dockers:
  - goos: linux
    goarch: amd64
    image_templates:
      - 'megabytelabs/{{.ProjectName}}'
      - 'megabytelabs/{{.ProjectName}}:{{.Tag}}'
      - 'megabytelabs/{{.ProjectName}}:v{{ .Major }}'
    dockerfile: .config/Dockerfile
    use: buildx
    build_flag_templates:
      - --platform=linux/amd64

brews:
  - name: ''
    description: A starting template for Go CLI projects
    license: MIT
    homepage: 'https://megabyte.space'
    folder: Formula
    tap:
      owner: installdoc
      name: homebrew-tap
    test: ''
    install: |-
      bin.install ""
      bash_completion.install "completion/bash/.bash" => ""
      zsh_completion.install "completion/zsh/_" => "_"
      fish_completion.install "completion/fish/.fish"

announce:
  skip: '{{gt .Patch 0}}'
  linkedin:
    enabled: false
    message_template: 'Go CLI {{ .Tag }} is out! Check it out at {{ .ReleaseURL }}.'
  reddit:
    enabled: false
    application_id: O3UxD7HlPpcN88gpEkPIXQ
    username: tsgangster
    url_template: 'https://github.com/ProfessorManhattan/go-cli-template/releases/tag/{{ .Tag }}'
    title_template: 'Go CLI {{ .Tag }} was just released!'
  slack:
    enabled: true
    message_template: '**[Go CLI](https://github.com/ProfessorManhattan/go-cli-template)** {{.Tag}} is out! Check it out at {{.ReleaseURL}}.'
    channel: '#go-lang'
    username: Megabyte Labs Release Notification Bot
    icon_url: 'https://gitlab.com/megabyte-labs/misc/assets/-/raw/master/logo/megabytelabs-color-icon-350x350.png'
  teams:
    enabled: false
    title_template: 'Go CLI {{ .Tag }} has been released!'
    message_template: 'Go CLI {{ .Tag }} is out! Check it out at {{ .ReleaseURL }}.'
    color: '#1DA1F2'
    icon_url: 'https://gitlab.com/megabyte-labs/misc/assets/-/raw/master/logo/megabytelabs-color-icon-350x350.png'
  twitter:
    enabled: false
    message_template: 'Go CLI {{ .Tag }} is out with new features! Check it out at {{ .ReleaseURL }}.'
